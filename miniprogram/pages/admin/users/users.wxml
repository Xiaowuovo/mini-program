<!--pages/admin/users/users.wxml-->
<view class="container">
  <!-- æœç´¢å’Œç­›é€‰ -->
  <view class="search-bar">
    <view class="search-input-wrapper">
      <input
        class="search-input"
        placeholder="æœç´¢ç”¨æˆ·æ˜µç§°æˆ–æ‰‹æœºå·"
        bindinput="onSearchInput"
        value="{{searchKeyword}}"
      />
      <text class="search-icon">ğŸ”</text>
    </view>

    <view class="filter-tabs">
      <view
        class="filter-tab {{roleFilter === 'all' ? 'active' : ''}}"
        data-role="all"
        bindtap="onFilterChange"
      >
        å…¨éƒ¨
      </view>
      <view
        class="filter-tab {{roleFilter === 'tenant' ? 'active' : ''}}"
        data-role="tenant"
        bindtap="onFilterChange"
      >
        ç§Ÿæˆ·
      </view>
      <view
        class="filter-tab {{roleFilter === 'admin' ? 'active' : ''}}"
        data-role="admin"
        bindtap="onFilterChange"
      >
        ç®¡ç†å‘˜
      </view>
    </view>
  </view>

  <!-- ç”¨æˆ·åˆ—è¡¨ -->
  <view class="users-list">
    <view
      class="user-card"
      wx:for="{{filteredUsers}}"
      wx:key="id"
      data-id="{{item.id}}"
      bindtap="onViewDetail"
    >
      <view class="user-header">
        <view class="user-avatar">
          {{item.nickname.substring(0, 1)}}
        </view>
        <view class="user-info">
          <view class="user-name">
            {{item.nickname}}
            <view class="role-badge role-{{item.role}}">
              {{item.role === 'admin' ? 'ç®¡ç†å‘˜' : 'ç§Ÿæˆ·'}}
            </view>
          </view>
          <view class="user-phone" wx:if="{{item.phone}}">ğŸ“± {{item.phone}}</view>
          <view class="user-meta">
            <text>æ³¨å†Œæ—¶é—´ï¼š{{item.created_at}}</text>
          </view>
        </view>
      </view>

      <view class="user-stats">
        <view class="stat-item">
          <view class="stat-value">{{item.total_orders || 0}}</view>
          <view class="stat-label">è®¢å•æ•°</view>
        </view>
      </view>
    </view>

    <view class="empty" wx:if="{{filteredUsers.length === 0 && !isLoading}}">
      <text class="empty-icon">ğŸ‘¥</text>
      <text class="empty-text">æš‚æ— ç”¨æˆ·</text>
    </view>
  </view>
</view>
