<!--pages/admin/stats/stats.wxml-->
<view class="container">
  <!-- æ€»è§ˆå¡ç‰‡ -->
  <view class="overview-section">
    <view class="section-header">
      <text class="section-title">æ•°æ®æ€»è§ˆ</text>
      <button class="refresh-btn" bindtap="onRefresh">ğŸ”„</button>
    </view>

    <view class="overview-grid">
      <view class="overview-card">
        <view class="card-label">èœåœ°å‡ºç§Ÿç‡</view>
        <view class="card-value">{{overview.rentRate}}%</view>
        <view class="card-detail">{{overview.rentedGardens}}/{{overview.totalGardens}} å·²å‡ºç§Ÿ</view>
      </view>
      <view class="overview-card">
        <view class="card-label">è®¢å•å®Œæˆç‡</view>
        <view class="card-value">{{overview.completedOrders}}/{{overview.totalOrders}}</view>
        <view class="card-detail">æ€»è®¢å•æ•°</view>
      </view>
      <view class="overview-card">
        <view class="card-label">æ€»æ”¶å…¥</view>
        <view class="card-value revenue">Â¥{{overview.totalRevenue}}</view>
        <view class="card-detail">æœ¬æœˆ Â¥{{overview.monthRevenue}}</view>
      </view>
      <view class="overview-card">
        <view class="card-label">ç”¨æˆ·æ´»è·ƒåº¦</view>
        <view class="card-value">{{overview.activeUsers}}/{{overview.totalUsers}}</view>
        <view class="card-detail">æ´»è·ƒç”¨æˆ·</view>
      </view>
    </view>
  </view>

  <!-- èœåœ°çŠ¶æ€ç»Ÿè®¡ -->
  <view class="stat-section">
    <view class="section-title">èœåœ°çŠ¶æ€åˆ†å¸ƒ</view>
    <view class="pie-chart">
      <view class="chart-item">
        <view class="chart-bar available" style="width: {{gardenStats.available / overview.totalGardens * 100}}%"></view>
        <view class="chart-label">
          <text class="label-color available">â—</text>
          <text>å¯ç”¨ ({{gardenStats.available}})</text>
        </view>
      </view>
      <view class="chart-item">
        <view class="chart-bar rented" style="width: {{gardenStats.rented / overview.totalGardens * 100}}%"></view>
        <view class="chart-label">
          <text class="label-color rented">â—</text>
          <text>å·²ç§Ÿ ({{gardenStats.rented}})</text>
        </view>
      </view>
      <view class="chart-item">
        <view class="chart-bar maintenance" style="width: {{gardenStats.maintenance / overview.totalGardens * 100}}%"></view>
        <view class="chart-label">
          <text class="label-color maintenance">â—</text>
          <text>ç»´æŠ¤ ({{gardenStats.maintenance}})</text>
        </view>
      </view>
    </view>
  </view>

  <!-- è®¢å•çŠ¶æ€ç»Ÿè®¡ -->
  <view class="stat-section">
    <view class="section-title">è®¢å•çŠ¶æ€åˆ†å¸ƒ</view>
    <view class="order-stats">
      <view class="order-stat-item">
        <view class="stat-count pending">{{orderStats.pending}}</view>
        <view class="stat-name">å¾…ç¡®è®¤</view>
      </view>
      <view class="order-stat-item">
        <view class="stat-count confirmed">{{orderStats.confirmed}}</view>
        <view class="stat-name">å·²ç¡®è®¤</view>
      </view>
      <view class="order-stat-item">
        <view class="stat-count in-progress">{{orderStats.in_progress}}</view>
        <view class="stat-name">è¿›è¡Œä¸­</view>
      </view>
      <view class="order-stat-item">
        <view class="stat-count completed">{{orderStats.completed}}</view>
        <view class="stat-name">å·²å®Œæˆ</view>
      </view>
      <view class="order-stat-item">
        <view class="stat-count cancelled">{{orderStats.cancelled}}</view>
        <view class="stat-name">å·²å–æ¶ˆ</view>
      </view>
    </view>
  </view>

  <!-- æ”¶å…¥è¶‹åŠ¿ -->
  <view class="stat-section">
    <view class="section-title">è¿‘7æ—¥æ”¶å…¥è¶‹åŠ¿</view>
    <view class="trend-chart">
      <view class="trend-item" wx:for="{{revenueTrend}}" wx:key="date">
        <view class="trend-bar" style="height: {{item.amount / 2500 * 200}}rpx">
          <text class="trend-amount">Â¥{{item.amount}}</text>
        </view>
        <text class="trend-date">{{item.date}}</text>
      </view>
    </view>
  </view>

  <!-- çƒ­é—¨èœåœ° -->
  <view class="stat-section">
    <view class="section-title">çƒ­é—¨èœåœ° TOP5</view>
    <view class="top-list">
      <view class="top-item" wx:for="{{topGardens}}" wx:key="name">
        <view class="top-rank rank-{{index + 1}}">{{index + 1}}</view>
        <view class="top-info">
          <view class="top-name">{{item.name}}</view>
          <view class="top-detail">{{item.orders}}ç¬”è®¢å• Â· Â¥{{item.revenue}}</view>
        </view>
      </view>
    </view>
  </view>
</view>
