<!--pages/admin/gardens/gardens.wxml-->
<view class="container">
  <!-- å¤´éƒ¨æ“ä½œæ  -->
  <view class="header-bar">
    <view class="filter-tabs">
      <view
        class="filter-tab {{statusFilter === 'all' ? 'active' : ''}}"
        data-status="all"
        bindtap="onFilterChange"
      >
        å…¨éƒ¨
      </view>
      <view
        class="filter-tab {{statusFilter === 'available' ? 'active' : ''}}"
        data-status="available"
        bindtap="onFilterChange"
      >
        å¯ç”¨
      </view>
      <view
        class="filter-tab {{statusFilter === 'rented' ? 'active' : ''}}"
        data-status="rented"
        bindtap="onFilterChange"
      >
        å·²ç§Ÿ
      </view>
      <view
        class="filter-tab {{statusFilter === 'maintenance' ? 'active' : ''}}"
        data-status="maintenance"
        bindtap="onFilterChange"
      >
        ç»´æŠ¤ä¸­
      </view>
    </view>
    <button class="add-btn" bindtap="onShowAddDialog">
      <text>â• æ·»åŠ èœåœ°</text>
    </button>
  </view>

  <!-- èœåœ°åˆ—è¡¨ -->
  <view class="gardens-list">
    <view
      class="garden-card"
      wx:for="{{filteredGardens}}"
      wx:key="id"
    >
      <view class="garden-header">
        <view class="garden-name">{{item.name}}</view>
        <view class="status-badge status-{{item.status}}">
          {{item.status === 'available' ? 'å¯ç”¨' : item.status === 'rented' ? 'å·²ç§Ÿ' : 'ç»´æŠ¤ä¸­'}}
        </view>
      </view>

      <view class="garden-info">
        <view class="info-row">
          <text class="label">ä½ç½®ï¼š</text>
          <text>{{item.location}}</text>
        </view>
        <view class="info-row">
          <text class="label">é¢ç§¯ï¼š</text>
          <text>{{item.area}}ã¡</text>
        </view>
        <view class="info-row">
          <text class="label">ä»·æ ¼ï¼š</text>
          <text class="price">Â¥{{item.price}}/æœˆ</text>
        </view>
        <view class="info-row" wx:if="{{item.current_tenant}}">
          <text class="label">ç§Ÿæˆ·ï¼š</text>
          <text>{{item.current_tenant.nickname}}</text>
        </view>
      </view>

      <view class="garden-actions">
        <button
          class="action-btn status-btn"
          data-id="{{item.id}}"
          bindtap="onStatusChange"
        >
          ä¿®æ”¹çŠ¶æ€
        </button>
        <button
          class="action-btn edit-btn"
          data-id="{{item.id}}"
          bindtap="onEdit"
        >
          ç¼–è¾‘
        </button>
      </view>
    </view>

    <view class="empty" wx:if="{{filteredGardens.length === 0 && !isLoading}}">
      <text class="empty-icon">ğŸŒ±</text>
      <text class="empty-text">æš‚æ— èœåœ°</text>
    </view>
  </view>

  <!-- æ·»åŠ èœåœ°å¼¹çª— -->
  <view class="dialog-mask" wx:if="{{showAddDialog}}" bindtap="onHideAddDialog">
    <view class="dialog" catchtap="doNothing">
      <view class="dialog-title">æ·»åŠ æ–°èœåœ°</view>

      <view class="form-group">
        <text class="form-label">åç§°</text>
        <input
          class="form-input"
          placeholder="è¯·è¾“å…¥èœåœ°åç§°"
          data-field="name"
          value="{{newGarden.name}}"
          bindinput="onInputChange"
        />
      </view>

      <view class="form-group">
        <text class="form-label">ä½ç½®</text>
        <input
          class="form-input"
          placeholder="è¯·è¾“å…¥èœåœ°ä½ç½®"
          data-field="location"
          value="{{newGarden.location}}"
          bindinput="onInputChange"
        />
      </view>

      <view class="form-group">
        <text class="form-label">é¢ç§¯ï¼ˆã¡ï¼‰</text>
        <input
          class="form-input"
          type="digit"
          placeholder="è¯·è¾“å…¥é¢ç§¯"
          data-field="area"
          value="{{newGarden.area}}"
          bindinput="onInputChange"
        />
      </view>

      <view class="form-group">
        <text class="form-label">ä»·æ ¼ï¼ˆå…ƒ/æœˆï¼‰</text>
        <input
          class="form-input"
          type="digit"
          placeholder="è¯·è¾“å…¥ç§Ÿé‡‘"
          data-field="price"
          value="{{newGarden.price}}"
          bindinput="onInputChange"
        />
      </view>

      <view class="dialog-actions">
        <button class="dialog-btn cancel-btn" bindtap="onHideAddDialog">å–æ¶ˆ</button>
        <button class="dialog-btn confirm-btn" bindtap="onConfirmAdd">ç¡®å®š</button>
      </view>
    </view>
  </view>
</view>
