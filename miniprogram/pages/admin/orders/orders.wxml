<!--pages/admin/orders/orders.wxml-->
<view class="container">
  <!-- ç­›é€‰æ  -->
  <view class="filter-bar">
    <scroll-view class="filter-scroll" scroll-x>
      <view class="filter-tabs">
        <view
          class="filter-tab {{statusFilter === 'all' ? 'active' : ''}}"
          data-status="all"
          bindtap="onFilterChange"
        >
          å…¨éƒ¨
        </view>
        <view
          class="filter-tab {{statusFilter === 'pending' ? 'active' : ''}}"
          data-status="pending"
          bindtap="onFilterChange"
        >
          å¾…ç¡®è®¤
        </view>
        <view
          class="filter-tab {{statusFilter === 'confirmed' ? 'active' : ''}}"
          data-status="confirmed"
          bindtap="onFilterChange"
        >
          å·²ç¡®è®¤
        </view>
        <view
          class="filter-tab {{statusFilter === 'in_progress' ? 'active' : ''}}"
          data-status="in_progress"
          bindtap="onFilterChange"
        >
          è¿›è¡Œä¸­
        </view>
        <view
          class="filter-tab {{statusFilter === 'completed' ? 'active' : ''}}"
          data-status="completed"
          bindtap="onFilterChange"
        >
          å·²å®Œæˆ
        </view>
        <view
          class="filter-tab {{statusFilter === 'cancelled' ? 'active' : ''}}"
          data-status="cancelled"
          bindtap="onFilterChange"
        >
          å·²å–æ¶ˆ
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- è®¢å•åˆ—è¡¨ -->
  <view class="orders-list">
    <view
      class="order-card"
      wx:for="{{filteredOrders}}"
      wx:key="id"
    >
      <view class="order-header">
        <view class="order-id">è®¢å• #{{item.id}}</view>
        <view class="status-badge status-{{item.status}}">
          {{statusMap[item.status]}}
        </view>
      </view>

      <view class="order-info">
        <view class="info-row">
          <text class="label">ç±»å‹ï¼š</text>
          <text>{{item.type === 'rental' ? 'èœåœ°ç§Ÿèµ' : 'æœåŠ¡è®¢å•'}}</text>
        </view>
        <view class="info-row" wx:if="{{item.garden}}">
          <text class="label">èœåœ°ï¼š</text>
          <text>{{item.garden.name}}</text>
        </view>
        <view class="info-row" wx:if="{{item.service}}">
          <text class="label">æœåŠ¡ï¼š</text>
          <text>{{item.service.name}}</text>
        </view>
        <view class="info-row" wx:if="{{item.user}}">
          <text class="label">ç”¨æˆ·ï¼š</text>
          <text>{{item.user.nickname}}</text>
        </view>
        <view class="info-row">
          <text class="label">é‡‘é¢ï¼š</text>
          <text class="price">Â¥{{item.total_price}}</text>
        </view>
        <view class="info-row">
          <text class="label">åˆ›å»ºæ—¶é—´ï¼š</text>
          <text class="date">{{item.created_at}}</text>
        </view>
      </view>

      <view class="order-actions">
        <button
          class="action-btn detail-btn"
          data-id="{{item.id}}"
          bindtap="onViewDetail"
        >
          æŸ¥çœ‹è¯¦æƒ…
        </button>
        <button
          class="action-btn status-btn"
          data-id="{{item.id}}"
          data-current-status="{{item.status}}"
          bindtap="onStatusChange"
        >
          æ›´æ–°çŠ¶æ€
        </button>
      </view>
    </view>

    <view class="empty" wx:if="{{filteredOrders.length === 0 && !isLoading}}">
      <text class="empty-icon">ğŸ“‹</text>
      <text class="empty-text">æš‚æ— è®¢å•</text>
    </view>
  </view>
</view>
