<!--pages/index/index.wxml-->
<view class="container">
  <!-- è½®æ’­å›¾ -->
  <swiper class="banner-swiper" indicator-dots indicator-color="rgba(255,255,255,0.5)" indicator-active-color="#4CAF50" autoplay circular>
    <swiper-item wx:for="{{banners}}" wx:key="id">
      <image src="{{item.image}}" class="banner-image" mode="aspectFill" binderror="onBannerError" data-index="{{index}}"></image>
    </swiper-item>
  </swiper>

  <!-- åŠŸèƒ½å…¥å£ -->
  <view class="function-grid">
    <view class="function-item" bindtap="navigateToGardens">
      <view class="function-icon-wrapper">
        <image src="/images/icon-garden.png" class="function-icon"></image>
      </view>
      <text>ç§Ÿç”¨èœåœ°</text>
    </view>
    <view class="function-item" bindtap="navigateToMyGardens">
      <view class="function-icon-wrapper">
        <image src="/images/icon-my-garden.png" class="function-icon"></image>
      </view>
      <text>æˆ‘çš„èœåœ°</text>
    </view>
    <view class="function-item" bindtap="navigateToServices">
      <view class="function-icon-wrapper">
        <image src="/images/icon-service.png" class="function-icon"></image>
      </view>
      <text>å¢å€¼æœåŠ¡</text>
    </view>
    <view class="function-item" bindtap="navigateToReminders">
      <view class="function-icon-wrapper">
        <image src="/images/icon-remind.png" class="function-icon"></image>
      </view>
      <text>ä»»åŠ¡æé†’</text>
    </view>
  </view>

  <!-- çƒ­é—¨èœåœ° -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">çƒ­é—¨èœåœ°</text>
      <text class="section-more" bindtap="navigateToGardens">æ›´å¤š ></text>
    </view>

    <view class="garden-list">
      <view
        wx:for="{{hotGardens}}"
        wx:key="id"
        class="garden-card"
        bindtap="navigateToGardenDetail"
        data-id="{{item.id}}"
      >
        <image src="{{item.image_url || (item.images && item.images.length > 0 ? item.images[0] : '/images/default-garden.png')}}" class="garden-image" mode="aspectFill" binderror="onGardenImageError" data-index="{{index}}"></image>
        <view class="garden-info">
          <view class="garden-name">{{item.name}}</view>
          <view class="garden-desc">
            <text class="garden-tag">{{item.area}}ã¡</text>
            <text class="garden-tag">{{item.location}}</text>
          </view>
          <view class="garden-footer">
            <view class="garden-price">
              <text class="price-number">{{item.price}}</text>
              <text class="price-unit">å…ƒ/æœˆ</text>
            </view>
            <view class="garden-status status-{{item.status}}">
              {{item.status === 'available' ? 'å¯ç§Ÿç”¨' : item.status === 'rented' ? 'å·²ç§Ÿå‡º' : 'ç»´æŠ¤ä¸­'}}
            </view>
          </view>
        </view>
      </view>
    </view>

    <view wx:if="{{hotGardens.length === 0}}" class="empty-state">
      <image src="/images/empty.png" class="empty-image"></image>
      <text>æš‚æ— çƒ­é—¨èœåœ°</text>
    </view>
  </view>

  <!-- æœ€æ–°åŠ¨æ€ -->
  <view class="section">
    <view class="section-header">
      <text class="section-title">ç¤¾åŒºåŠ¨æ€</text>
      <text class="section-more" bindtap="navigateToCommunity">æ›´å¤š ></text>
    </view>

    <view class="post-list">
      <view
        wx:for="{{latestPosts}}"
        wx:key="id"
        class="post-card"
        bindtap="navigateToPostDetail"
        data-id="{{item.id}}"
      >
        <view class="post-header">
          <image src="{{item.user_avatar || '/images/default-avatar.png'}}" class="user-avatar"></image>
          <view class="post-user">
            <view class="user-name">{{item.user_nickname}}</view>
            <view class="post-time">{{item.created_at}}</view>
          </view>
        </view>
        <view class="post-content">
          <view class="post-title">{{item.title}}</view>
          <view class="post-text">{{item.content}}</view>
        </view>
        <view class="post-footer">
          <text class="post-stat">ğŸ’¬ {{item.comment_count}}</text>
          <text class="post-stat">â¤ï¸ {{item.like_count}}</text>
        </view>
      </view>
    </view>

    <view wx:if="{{latestPosts.length === 0}}" class="empty-state">
      <image src="/images/empty.png" class="empty-image"></image>
      <text>æš‚æ— ç¤¾åŒºåŠ¨æ€</text>
    </view>
  </view>
</view>
